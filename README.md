# R4C - Robots for consumers

### Выполненое тестовое задание

Перед запуском проекта необходимо:

1. Клонировать репозиторий командой 
```
git clone https://github.com/Vladimir-Study/R4C_test
```
2. Выполнить установку зависимостей
```
pip install -r requirements.txt
```
3. Запуск выполняется командой выполненной в папке проекта 
```
python manage.py runserver
```

### [Поставленные задачи](tasks.md)

#### 1. Создать API-endpoint, принимающий и обрабатывающий информацию в формате JSON. В результате web-запроса на этот endpoint, в базе данных появляется запись отражающая информацию о произведенном на заводе роботе.

*Решение:*
В файл [views.py](robots/views.py) добавлен viewset принимающий POST
запрос отправленный на адрес:
http://localhost:8000/robots/add_robot/
Тело запроса:
```JSON
{
	"created": "2023-10-30 23:59:59",
	"model": "R2",
	"version": "D2"
}
```

*Обработка события:*
Происходит валидация тела запроса на наличие полей в запросе и количество полей.
При отправке любого запроса отличного от POST будет возбуждена ошибка.
При отправке некорректного JSON буде возбуждена ошибка.

*Результат запроса:*
Добавленная модель робота в базу данных с ароматическим присваиванием серийного номера.

#### 2. Скачивание по прямой ссылке Excel-файла со сводкой по суммарным показателям производства роботов за последнюю неделю.

*Решение:*
В файл [views.py](robots/views.py) добавлен viewset отображающий страницу с кнопкой "Получить отчет за неделю", находящейся по адресу: http://localhost:8000/robots/get_statistics/

*Обработка события:*
При загрузке страницы происходит формирование отчета о роботах выпущенных за последнюю неделю в формате Exel таблицы. Для каждой модели своя страница.
```
 __________________________________
|Модель|Версия|Количество за неделю|
 __________________________________
|  R2  |  D2  |       32           |
 __________________________________
|  R2  |  A1  |       41           |
...
...
...
|  R2  |  С8  |       99           |
...
```

*Результат нажатия на кнопку.*
Происходит скачивание сформированного отчета

#### 3. Информирование клиента о выпуске робота из заказа

*Правки таблицы заказов в БД.*
Добавлены поля model и version для идентификации робота заказанного клиентом.

*Решение:*
Добавлен post_save сигнал на добавление робота в БД.

*Обработка события:*
При обработке сигнал проверяется есть ли заказ на данную модель робота, 
если такой заказ присутствует, в заказе проставляется серийный номер робота, 
тем самым происходит бронирование робота под конкретный заказ. После чего 
на email отправляется информационное письмо о выпуске робота из заказа. 

*Содержание письма*
```
Добрый день!
Недавно вы интересовались нашим роботом модели X, версии Y. 
Этот робот теперь в наличии. Если вам подходит этот вариант - пожалуйста, свяжитесь с нами
```
